<script>
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': 'jrMKOnF5IuhcG1nrrLPbmzmtMxO19qgn8Qy3K1o9'
            }
        });
        function set_payment_channel(pid, name, post_did) {
            if(post_did){
                did = post_did;
            }
            var playerid = $('#form-webtopup').find('input[name="player_id"]').val();
            var influencer = $('#form-webtopup').find('input[name="influencer"]').val();
            var game = $('#form-webtopup').find('input[name="game"]').val();
            var popup_link = '';

            if (!playerid) {
                $('html,body').animate({scrollTop: $('#form-webtopup').offset().top - 200}, 400);
                $.alert({
                    title: 'ID Pengguna atau ID Zona tidak valid',
                    content: 'Silakan masukkan ID pemain Anda, Anda dapat menemukannya di dalam permainan',
                    escapeKey: true,
                    backgroundDismiss: true
                });
            } else if (!did || !pid) {
                $('html,body').animate({scrollTop: $('#game-denoms').offset().top - 200}, 400);
                $.alert({
                    title: 'Anda harus memilih denominasi terlebih dahulu',
                    content: 'Silahkan pilih item yang ingin Anda beli sebelum memilih channel pembayaran',
                    escapeKey: true,
                    backgroundDismiss: true
                });
            }
            else {
                something = $.ajax({
                    url: 'https://www.unipin.com/id/garena/inquiry',
                    dataType: 'json',
                    method: 'post',
                    //async: false,
                    data: {'rgid': 'RURnL3R2RzNhYkZ3VzdDTkNCTVZwQT09', 'playerid': playerid, 'game': game, 'did': did, 'pid': pid, 'influencer': influencer},
                    beforeSend: function() {
                        $('.loading').show();
                    }
                }).done(function (response) {
                    $('.loading').hide();
                    if (response.status === '1') {
                        if (response.is_popup === 1) {
                            popup_link = 'https://www.unipin.com/id/garena/checkout/' + response.message;
                            if (typeof popup_link !== 'undefined' && popup_link !== '') {
                                window.location.href = popup_link;
                                //window.open(popup_link,'Checkout menggunakan ' + name,'height=600px,width=900px,top=150,left=200');
                            }
                        } else {
                            $('#checkoutModalImage').attr('src', $('#image_'+pid).attr('src'));
                            $('#checkoutModalTitle2').html(name);
                            $('#checkoutModal').modal({backdrop: 'static', keyboard: false});
                            $('#checkoutIframe').attr('src', 'https://www.unipin.com/id/garena/checkout/' + response.message)
                        }
                    }
                    else {
                        $.alert({
                            title: 'Permintaan Gagal',
                            content: response.message,
                            escapeKey: true,
                            backgroundDismiss: true
                        });
                    }

                }).fail(function () {
                    $('.loading').hide();
                    $.alert({
                        title: 'Permintaan Gagal',
                        content: 'Gagal untuk meminta, silahkan coba lagi nanti',
                        escapeKey: true,
                        backgroundDismiss: true
                    });
                });
            }
        }
    </script> 
